# TagWriting

**TagWriting**は、ただタグで囲むだけ。

AIと人間のあいだを、テキストファイルでもっとシームレスに繋ぐツールです。

---

## ✨ 概要

`<prompt>`タグで囲んだ部分に、LLM（大規模言語モデル）による処理を加えます。テキストファイルやMarkdownファイルを監視して、**保存されたタイミングで自動的に変換**されます。

```markdown
わたしはTagWritingです。
<prompt>TagWritingの良いところを一行で説明する</prompt>
```

↓

```markdown
わたしはTagWritingです。
テキストをタグで囲むだけで素早い文章の生成が可能になります。
```

---

## 🛠️ 使い方

1. `.md`などのファイルを編集し、プロンプトをタグで囲む  
2. 保存すると、その部分がLLMによって変換される  
3. 結果はファイルに直接反映される

---

## 🔁 ユースケース：Promptの連鎖処理（Prompt Chain）

TagWritingでは、プロンプトを複数並べるだけで**段階的な生成処理**ができます。

```markdown
わたしはTagWritingです。
<prompt>なぜこのプロダクトを作ったか</prompt>
<prompt>TagWritingの良いところを一行で説明する</prompt>
```

保存後：

```markdown
わたしはTagWritingです。
テキスト生成AIを文章を作成するときに、上手い方法がないか探していたときに思いつきました。
<prompt>TagWritingの良いところを一行で説明する</prompt>
```


結果：

```markdown
わたしはTagWritingです。
テキスト生成AIを文章を作成するときに、上手い方法がないか探していたときに思いつきました。
TagWritingの良いところは、シームレスな文章との連携です。
```

---

## 💡 なぜTagWritingなのか？

### ✅ テキスト編集とのシームレスさ
テキスト内で直接プロンプトをタグで囲むだけ。LLMの操作にわざわざ手を止める必要はありません。**思考の流れを中断せずにAIの力を借りられます。**

### ✅ 可読性の高さ
タグを明示的に書くことで、**どの部分をAIに任せたいか**がはっきり見える。ドキュメントの履歴や編集も明快になります。

### ✅ 柔軟性と互換性
TagWritingはテキストファイルに直接書き換えを行うだけ。つまり、**どんなエディタでも、どんな形式でも対応可能**。エディタがファイルの再読込に対応していれば、それだけで連携完了。

---

## 🚀 インストール方法（Python）

1. 必要な依存パッケージをインストール

```sh
pip install .
```

2. コマンドラインツールとして使う

```sh
tagwriting <ファイル名>
```

---

## ⚙️ .envファイルの使い方

フォルダ直下に `.env` ファイルを作成し、APIキーやモデル名などを記載してください。

例:

```env
API_KEY=sk-xxxxxxx
MODEL=gpt-3.5-turbo
BASE_URL=https://api.openai.com/v1
```

- `.env` は `tagwriting` コマンドを実行したディレクトリのものが自動的に読み込まれます。
- 複数プロジェクトで使い分けたい場合は、各ディレクトリごとに `.env` を用意してください。
- OpenAPI互換ならとりあえず使えます(Grok、Deepseekなど)
---

## ⚙️ システム構成

### `tagwriting --watch <filename>`

指定したファイルを監視し、保存された瞬間に`<prompt>`タグを探索・処理します。

- LLMや外部APIへのリクエストは非同期で発行
- エラーや作業状況はCLIにリアルタイム出力
- 更新はファイルに直接反映（再保存で再処理）

---

## 🧪 開発について

TagWritingは現在、試験的に開発中です。  
コードの設計方針は以下の通り：

- シンプル：基本はタグ検出 → コンテキスト送信 → 結果で置換
- ステートレス：ファイルベースで完結、環境依存最小
- 最小インタフェース：UIに依存せず、あらゆるツールと併用可能

---

# 詳細な使い方

## YAMLテンプレートシステムについて

Tagwritingでは、YAMLファイルによるテンプレートシステムをサポートしています。これにより、独自のタグやプロンプトのフォーマットを柔軟に定義できます。

### 使い方

1. テンプレート用のYAMLファイルを作成します（例: `sample.yaml`）。

```yaml
- tag: summary
  format: 文章全体を要約する
- tag: detail
  format: 詳細に説明する: {prompt}
```

2. コマンドラインで`--templates`オプションを使い、テンプレートYAMLファイルを指定します。

```sh
python tagwriting/main.py test.md --templates sample.yaml
```

### テンプレートの書式

- `tag`: Markdown内で変換対象となるタグ名（例: `<summary>...</summary>`）。
- `format`: 変換後のプロンプトのフォーマット。`{prompt}`の部分がタグ内のテキストで置換されます。

#### 例

Markdownファイル内の

```markdown
<detail>この物語について説明してください。</detail>
```

はテンプレートに従って

```markdown
<prompt>詳細に説明する: この物語について説明してください。</prompt>
```

に自動変換されます。その後、LLMへの処理が行われます。

# 詳しい挙動の仕様

Tagwritingの内部で、以下の流れで動作します。

1. ファイルの監視
2. ファイルの変更を検知
3. ファイルを読み込む
4. イベントの発火
5. テンプレートタグの検出(`example: <summary></summary>`)
6. テンプレートタグをプロンプトタグに変換(`example: <prompt>文章の全体を要約して</prompt>`)
7. プロンプトの検出(`example: <prompt>文章の全体を要約して</prompt>`)
8. プロンプトの変換とマーキング(`example: @@prompt@@`)
9. 変換結果をファイルに書き込む(`example: Tagwritingは素晴らしいプロダクトです)
10. ファイルの監視を再開